function [ daughters ] = division_and_mutation( B_cells_trial, activation_energy, threshold_energy, p_mut, p_CDR, p_FR_lethal )
%   "division_and_mutation" divides the cells and then mutates cells with
%   probability p_mut. When a cell is undergoes mutation, the function
%   "mutation" is called.


%% Division
% size of daughters = (1, 2*nb_max_B_cells, nb_Ag +2)
daughters = cat(2,B_cells_trial, B_cells_trial);

%% Somatic Hyper-Mutation 
for n = 1:size(daughters,2)
    rand_mut = rand;   
    if rand_mut < p_mut 
        mutant = mutation(daughters(1,n,:), activation_energy, threshold_energy, p_CDR, p_FR_lethal);
        if ~isempty(mutant)
            daughters(1,n,:) = mutant(:);
        else            
            daughters(1,n,:) = NaN(;
        end
    end
end

daughters = daughters(:, :, isnan(daughters(1,1,:)) < 1);

end
